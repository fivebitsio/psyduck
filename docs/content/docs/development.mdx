---
title: Development Setup
description: Learn how to set up your development environment to contribute to Psyduck Tracker or run it locally for development purposes.
---

## Prerequisites

Before setting up the development environment, ensure you have the following installed:

- [Bun](https://bun.sh/) (version 1.0 or higher)
- [DuckDB](https://duckdb.org/) (optional, for direct database access)

## Clone the Repository

```bash
# Clone the repository
git clone https://github.com/fivebitsio/psyduck.git

# Navigate to the project directory
cd psyduck
```

## Install Dependencies

```bash
# Install project dependencies
bun install
```

## Project Structure

Understanding the project structure will help you navigate the codebase:

```
psyduck/
├── bin/                    # Command-line tools (migration, config, cli)
├── data/                   # Default data directory
├── docs/                   # Documentation
├── migrations/             # Database migration files
├── src/                    # Main application source code
│   ├── analytics/          # Analytics API and services
│   ├── auth/               # Authentication services
│   ├── config/             # Configuration management
│   ├── event/              # Event tracking handlers
│   ├── lib/                # Shared libraries
│   ├── index.ts            # Main application entry point (server logic)
│   └── utils.ts            # Utility functions
├── track/                  # Client-side tracking library
├── web/                    # Web interface
├── package.json            # Project dependencies and scripts
└── README.md               # Project overview
```

## Running in Development Mode

### Backend Server

To run the main analytics server in development mode:

```bash
# Run the development server with auto-reload
bun run dev
```

This command starts the server directly using Bun, making the API available at `http://localhost:9876`.

### Tracking Library Development

To develop the client-side tracking library:

```bash
# In a separate terminal, navigate to the track directory
cd track

# Start the tracking library development server
bun run dev
```

### Running All Services

To run both the main server and tracking library simultaneously:

```bash
# Run both services
bun run dev:all
```

## Database Setup

### Initial Database Setup

The first time you run the application, you need to set up the database:

```bash
# Run database migrations to create tables
psyduck migrate up
```

### Custom Database Path

To use a custom database file:

```bash
# Run migrations with custom database path
psyduck migrate up --db ./my-custom-db.db
```

### Direct Database Access

For debugging purposes, you can connect directly to the DuckDB database:

```bash
# Connect to the database directly
bun db
```

This command accesses the `data/psyduck.db` file using DuckDB's command-line interface.

## Configuration for Development

### Environment Configuration

The application uses a JSON configuration file stored at `data/config.json`. You can set up the configuration using the CLI:

1. Run `psyduck init` to create the initial configuration
2. This will create the file if it doesn't exist
3. Generates a JWT key if one doesn't exist
4. Prompts for an initial admin user if no users exist

### Demo Mode

For development, you can enable demo mode by setting `demoMode` to `true` in `data/config.json`:

```json
{
  "users": [...],
  "jwtKey": "your-jwt-key",
  "demoMode": true
}
```

When demo mode is enabled, analytics endpoints don't require authentication, making development and testing easier.

## Development Scripts

The project includes several scripts for development:

```bash
# Run the main server with auto-reload
bun run dev

# Build the single executable
bun run build:standalone

# Run ESLint for code linting
bun run lint

# Run Prettier for code formatting
bun run format
```

## Running the Server in Development

For development purposes, you can run the server in several ways:

```bash
# Run the development server directly (hot reload)
bun run dev

# Run the built binary (for testing production build)
./dist/psyduck server

# Run in interactive mode
./dist/psyduck interactive
```

## Development Workflow

### Code Changes

1. The main server supports hot reloading when you run `bun run dev`
2. For the tracking library, changes to `track/track.js` will be reflected when you reload the page
3. For production builds of the tracking library, use `bun --cwd track run build`

### Testing Changes

Since there are no explicit test files mentioned in the project, manual testing involves:

1. Starting the development server
2. Adding the tracking script to a test HTML page
3. Verifying that events are properly recorded
4. Checking the analytics endpoints for data

### Debugging

For debugging, you can:

1. Check the server console output for error messages
2. Use browser developer tools to inspect network requests
3. Query the database directly using `bun db`

## Adding New Features

When adding new features:

1. Add new endpoints in the appropriate handler files in `src/analytics/`, `src/auth/`, etc.
2. Update the database schema and create a new migration if needed
3. Update documentation in the `docs/` directory
4. Follow the existing code patterns and structure

## Contributing

To contribute to the project:

1. Fork the repository
2. Create a feature branch
3. Make your changes following the existing code style
4. Test your changes thoroughly
5. Update documentation if needed
6. Submit a pull request
